# NFC + AI 기반 병원 검사·진료 안내 시스템 명세서

## 1. 시스템 개요

### 1.1 프로젝트 명칭
**NFC + AI 기반 병원 검사·진료 안내 시스템**

### 1.2 시스템 목적
본 시스템은 NFC(Near Field Communication)와 AI 기술을 활용하여 병원 방문 환자에게 검사·진료 과정을 안내하고, 대기시간을 예측하며, 개인 맞춤형 경로를 제공하는 통합 환자 안내 시스템입니다.

### 1.3 타겟 사용자
- **주요 타겟**: 종합병원 내 외래 환자, 보호자, 간호사
- **특별 고려 대상**: 고령층 환자, 디지털 취약계층

### 1.4 시스템 방향성
- 초기 계획: 건강검진센터 중심
- **변경된 방향**: 일반 병원 전체 프로세스(접수, 진료, 검사, 수납)로 범위 확대
- 변경 사유: 대형 병원의 기존 시스템과 차별화 및 일반 병원의 높은 수요

## 2. 사용자 페르소나 및 Pain Point

| 유형 | 특성 | 주요 Pain Point | 제공 솔루션 |
|------|------|----------------|-------------|
| **고령 환자** | 스마트폰 미숙, 청력 저하 | 위치 혼란, 대기정보 부족, 안내 누락 | NFC 태깅 + TTS 안내 + 큰 글씨 UI |
| **보호자** | 초진/대리진료 많음 | 진료실/수납 동선 반복 질문 | PWA 링크 공유 + 챗봇 질문 추천 |
| **간호사** | 응대 시간 부족, 업무 과중 | 대기 상태 추정, 누락 환자 파악 어려움 | 전용 큐잉 대시보드 (예상 대기 + 도착 여부) |

## 3. 시스템 구성 요소

### 3.1 하드웨어 구성
- **NFC 태그**: 병원 내 주요 위치에 설치
- **환자 스마트폰**: NFC 지원 Android/iOS 기기
- **관리자 PC**: 웹 기반 대시보드 접속용

### 3.2 소프트웨어 구성

#### 3.2.1 프론트엔드
- **환자용 PWA (Progressive Web App)**
  - Web NFC API 활용
  - 반응형 웹 디자인
  - 오프라인 지원
  
- **관리자 대시보드**
  - React 기반 웹 애플리케이션
  - 실시간 모니터링 인터페이스

#### 3.2.2 백엔드
- **Django 서버**
  - JWT 기반 인증
  
- **Python AI 서버**
  - Flask 프레임워크
  - LSTM 대기시간 예측
  - BERT 기반 챗봇

#### 3.2.3 데이터베이스
- **RDS (MySQL)**
  - 환자/태그/검사/대기 데이터
  - AES-256-GCM 암호화

#### 3.2.4 인프라
- **AWS EC2**: 서버 호스팅
- **S3 Storage**: 정적 파일 저장
- **CloudFront**: CDN 서비스
   
## 4. 주요 기능

### 4.1 환자용 기능

#### 4.1.1 NFC 기반 자동 인증
- NFC 태그 터치로 간편 로그인
- 스마트폰 UUID 기반 자동 인증
- 초기 등록 시 SMS 인증

#### 4.1.2 검사 안내
- 검사 전 준비사항 체크리스트
- 단계별 진행 상황 표시
- 검사 장소까지 최적 경로 안내
- 진행 중인 검사/진료에 대한 정보 안내
- 진행 예정인 검사/진료에 대한 정보 안내
- 진행 완료된 검사/진료에 대한 정보 안내
- 오늘 진행해야 될 검사/진료에 대한 일정 목록으로 정보 안내

#### 4.1.3 대기 관리
- 실시간 대기 순서 및 예상 시간
- 순서 임박 시 푸시 알림
- 대기 중 임시 이탈 기능

#### 4.1.4 AI 챗봇
- 자연어 기반 질의응답
- 의료 용어 쉬운 설명 제공
- 24시간 상담 지원

#### 4.1.5 사후 관리
- 카카오톡 '나에게 보내기' 일정 전송
- 구글/네이버 캘린더 연동
- 다음 진료 예약 안내

### 4.2 관리자용 기능

#### 4.2.1 통합 모니터링
- 실시간 병원 현황 대시보드
- 부서별 환자 현황 시각화
- 시스템 알림 및 경고

#### 4.2.2 NFC 태그 관리
- 태그 등록/수정/삭제
- 태그-위치 매핑 관리
- 오작동 태그 감지

#### 4.2.3 콘텐츠 관리
- 검사별 준비사항 편집
- 챗봇 응답 관리
- 공지사항 발송

#### 4.2.4 대기열 관리
- 실시간 대기열 모니터링
- 수동 순서 조정
- 대기 시간 알림 설정

#### 4.2.5 분석 및 보고
- 환자 흐름 분석
- 혼잡도 예측
- 커스텀 보고서 생성

## 5. 기술 스택

### 5.1 핵심 기술
- **NFC (Near Field Communication)**: 단거리 무선 통신
- **UUID (Universally Unique Identifier)**: 기기 식별
- **AES-256 암호화**: 데이터 보안
- **JWT (JSON Web Token)**: 인증 토큰

### 5.2 AI/ML 기술
- **LSTM (Long Short-Term Memory)**: 시계열 대기시간 예측
- **BERT (Bidirectional Encoder Representations from Transformers)**: 자연어 처리
- **Queueing Theory**: 대기행렬 이론 적용

### 5.3 웹 기술
- **PWA (Progressive Web App)**: 모바일 웹앱
- **Web NFC API**: 브라우저 NFC 지원
- **Deep Link/Universal Link**: 앱 자동 실행

### 5.4 보안 기술
- **RBAC (Role-Based Access Control)**: 역할 기반 접근 제어
- **HTTPS/TLS**: 통신 암호화
- **OAuth 2.0**: 외부 서비스 연동

## 6. 시스템 아키텍처

### 6.1 데이터 흐름
1. **NFC 태그 스캔**: NFC → 스마트폰(Web NFC) → 웹앱 → API → DB
2. **AI 응답**: 웹앱 ← AI 답변(Python) ← API
3. **EMR 연동**: API ↔ 가상 DB ↔ 병원 EMR/HIS (읽기 전용)

### 6.2 API 구조
- **Base URL**: https://api.nfc-hospital.kr/v1
- **인증**: JWT Bearer Token
- **프로토콜**: HTTPS only
- **데이터 형식**: JSON

### 6.3 주요 API 엔드포인트
- `/auth/*`: 인증 관련
- `/user/*`: 사용자 정보
- `/exam/*`: 검사 정보
- `/navigation/*`: 경로 안내
- `/queue/*`: 대기열 관리
- `/chatbot/*`: AI 챗봇
- `/admin/*`: 관리자 기능

## 7. 보안 및 법적 준수

### 7.1 개인정보 보호
- 개인정보보호법 준수
- 의료법 준수
- 민감정보 접근 제한 (환자 본인만)
- AES-256-GCM 암호화 저장

### 7.2 접근 제어
- JWT 토큰 기반 인증
- RBAC 권한 관리
- 접근 로그 감사 추적

### 7.3 데이터 보안
- HTTPS 암호화 통신
- EMR 데이터 가상 DB 중계
- 외부 직접 노출 차단

## 8. 전체 사용 시나리오

### 8.1 환자 사용 흐름
1. **병원 입구 (비로그인)**
   - NFC 태그 터치 → PWA 자동 실행
   - 음성 입력: "귀 검사 받으러 왔어요"
   - AI 분석 → 이비인후과 위치 안내

2. **접수창구**
   - 신분증/진료카드 제시
   - EMR 도착 처리
   - 가상 DB 실시간 동기화

3. **웹앱 로그인**
   - 카카오톡/PASS 간편 인증
   - JWT 토큰 발급
   - 개인 진료 정보 접근 권한 획득

4. **검사 진행**
   - NFC 태그로 위치 확인
   - 실시간 대기 현황 확인
   - AI 챗봇 질의응답
   - 순서 임박 시 푸시 알림

5. **검사 완료**
   - 검사 완료 알림
   - 다음 일정 안내
   - 카카오톡 일정 전송

### 8.2 관리자 사용 흐름
1. **일일 시스템 점검** (15-20분)
   - 시스템 로그인
   - 오류 태그 확인
   - 콘텐츠 업데이트

2. **운영 중 모니터링** (수시)
   - 대기열 상태 확인
   - 환자 피드백 대응
   - 실시간 이슈 해결

3. **일일 마감** (20-30분)
   - 통계 확인
   - 콘텐츠 업데이트
   - 백업 상태 점검

## 9. 상세 구현 사항

### 8.1 PWA 특화 기능
- **Web NFC API 연동**: 브라우저 내장 NFC 기능 활용
- **오프라인 지원**: Service Worker 기반 캐싱
- **설치 프롬프트**: 홈 화면 추가 유도
- **푸시 알림**: Web Push API 활용

### 8.2 NFC 구현 세부사항
```javascript
// NFC 태그 스캔 처리
if ('NDEFReader' in window) {
  const ndef = new NDEFReader();
  await ndef.scan();
  ndef.addEventListener("reading", ({ message }) => {
    // 태그 정보 처리
  });
}
```

### 8.3 QR 코드 백업 시스템
- NFC 미지원 기기를 위한 QR 코드 자동 생성
- 동일 URL로 리다이렉트 처리
- NFC 태그와 1:1 매핑

### 8.4 카카오톡 연동 기능
- **나에게 보내기**: 다음 진료 일정 전송
- **캘린더 연동 링크 포함**: 구글/네이버 캘린더 등록
- **처방전 안내**: 수령 장소 및 시간 정보

### 8.5 FSM (Finite State Machine) 기반 상태 관리
- **환자 상태**: 미도착 → 도착 → 대기 → 검사중 → 완료
- **검사 상태**: 예약 → 준비 → 진행 → 완료 → 결과
- **실시간 상태 전이**: WebSocket 기반 업데이트

## 9. MVP (Minimum Viable Product) 범위

### 9.1 필수 기능 (1차 개발)
1. NFC 태그 매핑 및 스캔
2. 기본 검사 안내 정보
3. 실시간 대기열 관리
4. 간단한 챗봇 FAQ
5. 관리자 대시보드 기본 기능

### 9.2 확장 기능 (2차 개발)
1. LSTM 기반 정밀 예측
2. BERT 고도화 챗봇
3. 실시간 혼잡도 히트맵
4. 고급 분석 리포트
5. 병원 EMR 완전 연동

## 10. 개발 일정

### 10.1 개발 기간
- **총 기간**: 2025년 2월 ~ 10월 (9개월)
- **MVP 완성**: 2025년 7월 (여름 방학 8주)

### 10.2 주요 마일스톤
1. **2-3월**: 계획 및 분석
2. **4-5월**: 설계 및 프로토타입
3. **6-8월**: 핵심 기능 개발
4. **9-10월**: 테스트 및 최종화

## 11. 법적 고려사항 및 특이사항

### 11.1 의료 정보 관련
- 챗봇 응답은 의료적 조언이 아님을 명확히 고지
- 대기시간 예측은 통계적 예상값임을 안내
- 검사 준비사항은 "정보성 안내"로 표시

### 11.2 개인정보 처리
- 전화번호는 서버 미저장 또는 익명화 처리
- NFC 태그 ID 마스킹 저장 (tag_001 형태)
- 챗봇 로그 익명화 및 마스킹 처리
- JWT 토큰 httpOnly 설정으로 XSS 방지

### 11.3 접근성 고려
- WCAG 2.1 기준 준수
- 고령층/장애인 접근성 설정 제공
- TTS 음성 안내 기본 탑재
- 큰 글씨 모드 및 고대비 UI 지원

## 12. 기대 효과

### 12.1 환자 측면
- 병원 내 이동 시간 단축
- 대기 불안감 해소
- 검사 준비 실수 감소
- 24시간 정보 접근 가능

### 12.2 병원 측면
- 간호사 업무 부담 경감
- 환자 만족도 향상
- 운영 효율성 증대
- 데이터 기반 의사결정 지원

### 12.3 차별화 요소
- NFC 기반 간편 인증 (터치 한 번)
- AI 예측 기반 정확한 대기시간 안내
- 고령층 친화적 UI/UX 설계
- 실시간 양방향 소통 시스템
- FSM 기반 체계적 상태 관리
- 카카오톡 연동 사후 관리